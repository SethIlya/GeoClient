<!-- geoclient/templates/geoclient/vue_app_container.html -->
{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Карта точек RINEX</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
          rel="stylesheet" 
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" 
          crossorigin="anonymous">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- 
      Путь к вашему скомпилированному CSS-файлу.
      Имя файла (например, 'assets/index.css' или 'assets/style.css')
      зависит от настроек сборки в vite.config.js
    -->
    <link rel="stylesheet" href="{% static 'assets/index.css' %}">

    <script>
      // --- ИСПРАВЛЕННЫЙ БЛОК НАСТРОЕК ---
      // Передаем все необходимые URL и CSRF-токен из Django в глобальный объект window.
      // Vue-приложение будет использовать этот объект для всех API-запросов.
      window.djangoSettings = {
        // CSRF-токен для Axios
        csrfToken: "{{ csrf_token|escapejs }}", 
        
        // URL-адреса для API, обернутые в escapejs для безопасности
        apiPointsUrl: "{{ api_points_url|escapejs }}",
        apiUploadUrl: "{{ api_upload_url|escapejs }}",
        apiKmlUploadUrl: "{{ api_kml_upload_url|escapejs }}", // <-- Добавленный URL
        apiStationNamesUrl: "{{ api_station_names_url|escapejs }}", // <-- Добавленный URL
        apiCsrfUrl: "{{ api_csrf_url|escapejs }}"
      };

      // Для отладки: выводим настройки в консоль браузера
      console.log("Django Settings from template:", JSON.parse(JSON.stringify(window.djangoSettings)));
      // --- КОНЕЦ ИСПРАВЛЕНИЙ ---
    </script>
</head>
<body>
    <noscript>
      <strong>JavaScript необходим для работы этого приложения. Пожалуйста, включите его в настройках вашего браузера.</strong>
    </noscript>
    
    <!-- Сюда будет смонтировано Vue-приложение -->
    <div id="app">Загрузка Vue приложения...</div>

    <!-- Bootstrap JS Bundle (включает Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" 
            crossorigin="anonymous"></script>
    
    <!-- 
      Главный JS-файл вашего Vue-приложения.
      Имя файла (например, 'assets/index.js' или 'assets/main.js')
      зависит от конфигурации Vite (входная точка).
    -->
    <script type="module" src="{% static 'assets/index.js' %}"></script>
</body>
</html>